var objOkTab="";layui.use(["element","form","layer","okUtils","okMock","okTab","okLayer","okContextMenu","laydate","okToastr"],function(){var g=layui.okUtils;var c=layui.jquery;var a=layui.form;var i=layui.laydate;var d=layui.layer;var b=layui.okLayer;var e=layui.okToastr;e.options.closeButton=true;var h=layui.okMock;g.ajax(h.api.login.index.islogin,"post",null,true).done(function(j){if(!j.data.state){window.location=j.data.url}}).fail(function(j){});var f=layui.okTab({url:h.api.admin.nav,openTabNum:30,parseData:function(j){console.log(j);return j}});objOkTab=f;okLoading&&okLoading.close();c(".layui-layout-admin").removeClass("orange_theme blue_theme");c(".layui-layout-admin").addClass(config.theme);if(config.menuArrow){c("#navBar").addClass(config.menuArrow)}f.render(function(){c("body .ok-tab").okContextMenu({width:"auto",itemHeight:30,menu:[{text:"定位所在页",icon:"ok-icon ok-icon-location",callback:function(){f.positionTab()}},{text:"关闭当前页",icon:"ok-icon ok-icon-roundclose",callback:function(){f.tabClose(1)}},{text:"关闭其他页",icon:"ok-icon ok-icon-roundclose",callback:function(){f.tabClose(2)}},{text:"关闭所有页",icon:"ok-icon ok-icon-roundclose",callback:function(){f.tabClose(3)}}]})});c("body").on("click","#navBar .layui-nav-item a, #userInfo a",function(){if(c(this).siblings().length==0){f.tabAdd(c(this))}c(this).parent("li").siblings().removeClass("layui-nav-itemed");if(!c(this).attr("lay-id")){var j=c(this).parents("li.layui-nav-item");var k=c("#navBar > li > dl.layui-nav-child").not(j.children("dl.layui-nav-child"));k.removeAttr("style")}});c("#navBar").on("click",".layui-nav-item a",function(){if(!c(this).attr("lay-id")){var k=c(this).parent();var l=c(this).next(".layui-nav-child");var j=l.height();l.css({display:"block"});if(k.is(".layui-nav-itemed")){l.height(0);l.animate({height:j+"px"},function(){l.css({height:"auto"})})}else{l.animate({height:0},function(){l.removeAttr("style")})}}});c(".ok-menu").click(function(){c(".layui-layout-admin").toggleClass("ok-left-hide");c(this).find("i").toggleClass("ok-menu-hide");localStorage.setItem("isResize",false);setTimeout(function(){localStorage.setItem("isResize",true)},1200)});c("body").on("click",".layui-layout-admin .ok-left a[data-url], .ok-make",function(){if(c(".layui-layout-admin").hasClass("ok-left-hide")){c(".layui-layout-admin").removeClass("ok-left-hide");c(".ok-menu").find("i").removeClass("ok-menu-hide")}});c("body").on("click",".okNavMove",function(){var j=c(this).attr("data-id");var k=this;f.navMove(j,k)});c("body").on("click",".ok-refresh",function(){f.refresh(this,function(j){})});c("body").on("click","#tabAction a",function(){var j=c(this).attr("data-num");f.tabClose(j)});c("body").on("keydown",function(j){j=j||window.event||arguments.callee.caller.arguments[0];if(j&&j.keyCode===27){console.log("Esc");c("#fullScreen").children("i").eq(0).removeClass("layui-icon-screen-restore")}if(j&&j.keyCode==122){console.log("F11");c("#fullScreen").children("i").eq(0).addClass("layui-icon-screen-restore")}});c("#logout").click(function(){b.confirm("确定要退出吗？",function(j){f.removeTabStorage(function(k){f.removeTabStorage();g.ajax(h.api.login.index.logout,"POST",null,function(l){window.location="pages/login.html"})})})})});