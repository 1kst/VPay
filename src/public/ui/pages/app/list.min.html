<!DOCTYPE html><html><head><meta charset="utf-8"><title>Ankioの用户中心</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon"/><link rel="stylesheet" href="../../css/okadmin.min.css"><link rel="stylesheet" href="../../lib/loading/okLoading.min.css"/><script type="text/javascript" src="../../lib/loading/okLoading.min.js"></script><link rel="stylesheet" href="../../css/oksub.min.css"/> <style>.okadmin .content-body {bottom: 0 !important;}::-webkit-scrollbar {overflow:auto;width: 4px !important;height: 4px !important;}.layui-layer-iframe{overflow: hidden !important;}.layui-table-cell{height:36px!important;line-height: 36px!important;}</style>
</head><body ><div class="ok-body"><table class="layui-hide" id="tableId" lay-filter="tableFilter"></table><script type="text/html" id="toolbarTpl"><div class="layui-btn-container"><button class="layui-btn layui-btn-sm" lay-event="add">添加APP</button></div></script><script type="text/html" id="operationTpl"><a href="javascript:" title="编辑" lay-event="edit"><i class="layui-icon">&#xe642;</i></a><a href="javascript:" title="删除" lay-event="del"><i class="layui-icon">&#xe640;</i></a></script></div><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="../../lib/layui/layui.js"></script>
<script> layui.use(["element", "jquery", "okMock", "table", "okLayer","okToastr", "okUtils"], function () { let table = layui.table; let okLayer = layui.okLayer; let okUtils = layui.okUtils; let okToastr=layui.okToastr; let $ = layui.jquery; let okMock = layui.okMock; okLoading.close($); const clipboard = new ClipboardJS('.btn-Clipboard'); clipboard.on('success', function(e) { okToastr.success("复制成功"); e.clearSelection(); }); let userTable = table.render({ elem: '#tableId', url: okUtils.getUrl(okMock.api.app.list), limit: 20, page: true, toolbar: "#toolbarTpl", size: "sm", cols: [[ { field: "icon", title: "LOGO", width: 100, templet: function(d) {return '<div><img style="height:35px;width:35px;border-radius:50%;line-height:50px!important;" src="'+d.icon+'" alt=""></div>'}}, { field: "title", title: "网站名称",templet:function (d) { return "<span class='btn-Clipboard' data-clipboard-text='"+d.title+"'>"+d.title+"</span>" }}, { field: "appkey", title: "appKey",templet:function (d) { return "<span class='btn-Clipboard' data-clipboard-text='"+d.appkey+"'>"+d.appkey+"</span>" }}, { field: "appid", title: "appId",templet:function (d) { return "<span class='btn-Clipboard' data-clipboard-text='"+d.redirect+"'>"+d.appid+"</span>" }}, { field: "redirect", title: "回调链接",templet:function (d) { return "<span class='btn-Clipboard' data-clipboard-text='"+d.redirect+"'>"+d.redirect+"</span>" }}, { field: "allow", title: "允许登录设备数"}, {title: "操作", width: 100, align: "center", fixed: "right", templet: "#operationTpl"} ]], done: function (res, curr, count) { console.info(res, curr, count); } }); table.on("toolbar(tableFilter)", function (obj) { switch (obj.event) { case "add": add(); break; } }); table.on("tool(tableFilter)", function (obj) { let data = obj.data; switch (obj.event) { case "edit": edit(data); break; case "del": del(data.id); break; } }); function add() { okLayer.openRight( "./edit.min.html",2,function () { userTable.reload(); },  function () { userTable.reload(); }); } function edit(data) { okLayer.openRight( "./edit.min.html?id="+data.id,2,function () { userTable.reload(); }, function () { userTable.reload(); }); } function del(id) { okLayer.confirm("确定要删除吗？", function () { okUtils.ajax(okMock.api.app.del, 'POST', { idsStr: id }, true).done(function (response) { okUtils.tableSuccessMsg(response.msg); userTable.reload(); }).fail(function (error) { }); }) } }) </script> </body></html>